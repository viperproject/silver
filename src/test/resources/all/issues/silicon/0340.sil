field next: Ref

method test1()
  requires forall r: Ref :: { r.next } acc(r.next) // Effectively assumes false, since "all r" includes null
{
  assert acc(null.next)
  //:: UnexpectedOutput(assert.failed:assertion.false, /silicon/issue/340/)
  assert false // Should hold since y.next was mentioned
}

method test2()
  requires forall r: Ref :: { r.next } acc(r.next)
{
  assume null.next == null
  //:: UnexpectedOutput(assert.failed:assertion.false, /silicon/issue/340/)
  assert false // Should hold since y.next was mentioned
}

method test99() {
  inhale forall r: Ref :: { r.next } r != null ==> acc(r.next)
  var x: Ref
  assume x != null
  assert acc(x.next)
}
